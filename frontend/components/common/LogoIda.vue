<script setup lang="ts">

// #region Imports
// Vue
import { resolveComponent, useCssModule, defineProps, withDefaults, computed, ref } from 'vue';
// Utils
import gsap from 'gsap';
// #endregion

// #region Props
const props = withDefaults(defineProps<{
    color?: 'black' | 'white',
    text?: string,
    isTouch?: boolean,
    to?: string,
    external?: boolean,
    target?: '_blank' | '_self',
}>(), {
    color: 'black',
    text: 'Лучшие цифровые <br>продукты для недвижимости',
    isTouch: false,
    to: '/',
    external: false,
    target: '_self',
});

// #endregion

// #region Data
// Nuxt
const $style = useCssModule();

const data = reactive<{
    isHoverLogo: boolean
}>({
    isHoverLogo: false,
});

const rectangleTop: Ref<HTMLElement | null> = ref(null);
const rectangleBottom: Ref<HTMLElement | null> = ref(null);
// #endregion

// #region Computed
const classList = computed(() => [
    {
        [$style[`_${props.color}`]]: props.color,
    },
]);

const componentBind = computed(() => ({
    is: props.to ? resolveComponent('NuxtLink') : 'a',
    external: props.external,
    target: props.target,
    to: props.to,
}));
// #endregion

// #region Methods
function onMouseenter() {
    if (data.isHoverLogo || props.isTouch) {
        return;
    }

    data.isHoverLogo = true;

    if (!rectangleTop.value || !rectangleBottom.value) {
        return;
    }

    const rectangleTopElement = rectangleTop.value as HTMLElement;
    const rectangleBottomElement = rectangleBottom.value as HTMLElement;

    const animationElements: HTMLElement[] = [rectangleTopElement, rectangleBottomElement];
    handleInitAnimation(animationElements);
}

function handleInitAnimation(animationElements: HTMLElement[]) {
    if (!animationElements.length) {
        return;
    }

    const tl = gsap.timeline({
        onComplete: () => {
            data.isHoverLogo = false;
        },
    });

    tl
        .set(animationElements, {
            backgroundPosition: '100%',
        })
        .to(animationElements, {
            backgroundPosition: '0%',
            ease: 'power1.inOut',
            duration: 0.6,
            stagger: 0,
        })
        .to(animationElements, {
            backgroundPosition: '-100%',
            ease: 'power2.inOut',
            duration: 0.8,
            delay: 1,
            stagger: 0,
        });
}

// #endregion
</script>

<template>
    <component
        :is="componentBind.is"
        v-bind="componentBind"
        :class="[$style.LogoIda, classList]"
        aria-label="Logo Ida"
    >
        <div
            :class="$style.wrapper"
            @mouseenter="onMouseenter"
        >
            <div :class="$style.inner">
                <svg
                    viewBox="0 0 88 28"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    :class="$style.logoIcon"
                >
                    <path
                        d="M6.84417 0.738511H9.01244V10.9737H6.84417V4.11591L2.16826 10.9737H0V0.738511H2.16826V7.61687L6.84417 0.738511Z"
                        fill="currentColor"
                    />
                    <path
                        d="M19.9972 8.70835H21.5999V10.9737H19.507H12.3046H10.2118V8.70835H10.438C10.5888 8.70835 10.7397 8.70148 10.8905 8.68775C11.0539 8.66029 11.2048 8.59851 11.343 8.50241C11.4939 8.39257 11.6196 8.22096 11.7201 7.98756C11.8207 7.74043 11.8835 7.40407 11.9087 6.97846C11.9212 6.73133 11.9275 6.36064 11.9275 5.86639C11.9401 5.37214 11.9464 4.82983 11.9464 4.23947C11.9589 3.64911 11.9652 3.04503 11.9652 2.42721C11.9778 1.79566 11.9841 1.23276 11.9841 0.738511H19.9972V8.70835ZM17.829 8.70835V3.02443H14.0581C14.0455 3.69717 14.0329 4.37677 14.0204 5.06323C14.0204 5.73596 14.0078 6.30573 13.9827 6.77252C13.9575 7.17067 13.9198 7.53449 13.8695 7.864C13.8192 8.17977 13.7564 8.46122 13.681 8.70835H17.829Z"
                        fill="currentColor"
                    />
                    <path
                        d="M29.8397 0.738511H31.9891V10.9737H29.8397V9.49092H29.7454C29.4312 10.0126 29.0038 10.4382 28.4633 10.7677C27.9354 11.0972 27.3006 11.262 26.559 11.262C25.9054 11.2757 25.2958 11.1522 24.7301 10.8913C24.1645 10.6304 23.6743 10.2666 23.2595 9.79982C22.8447 9.3193 22.5179 8.74267 22.2791 8.06994C22.0528 7.3972 21.9397 6.66269 21.9397 5.86639C21.9397 5.07009 22.0528 4.34244 22.2791 3.68344C22.5053 3.0107 22.8196 2.43407 23.2218 1.95355C23.6366 1.47303 24.1268 1.10234 24.6924 0.84148C25.2581 0.580624 25.8803 0.450195 26.559 0.450195C27.2881 0.463924 27.9228 0.628676 28.4633 0.944449C29.0038 1.26022 29.4312 1.66524 29.7454 2.15949H29.8397V0.738511ZM26.9927 8.99666C27.42 8.99666 27.8034 8.91429 28.1428 8.74954C28.4948 8.58478 28.7901 8.35825 29.029 8.06994C29.2804 7.78162 29.4752 7.44526 29.6134 7.06084C29.7517 6.67642 29.8208 6.2714 29.8208 5.8458C29.8208 5.40646 29.7517 4.99458 29.6134 4.61016C29.4752 4.22574 29.2804 3.89624 29.029 3.62166C28.7901 3.33334 28.4948 3.10681 28.1428 2.94206C27.8034 2.77731 27.42 2.69493 26.9927 2.69493C26.5653 2.69493 26.1757 2.77731 25.8237 2.94206C25.4718 3.10681 25.1701 3.33334 24.9187 3.62166C24.6673 3.89624 24.4725 4.22574 24.3342 4.61016C24.1959 4.99458 24.1268 5.40646 24.1268 5.8458C24.1268 6.28513 24.1959 6.69701 24.3342 7.08143C24.4725 7.46585 24.6673 7.80222 24.9187 8.09053C25.1701 8.36512 25.4718 8.58478 25.8237 8.74954C26.1757 8.91429 26.5653 8.99666 26.9927 8.99666Z"
                        fill="currentColor"
                    />
                    <path
                        d="M8.82389 24.6171H6.65563V16.6679H2.16826V24.6171H0V14.382H8.82389V24.6171Z"
                        fill="currentColor"
                    />
                    <path
                        d="M16.2869 14.0936C16.9656 14.0936 17.5878 14.2241 18.1535 14.4849C18.7191 14.7458 19.203 15.1165 19.6053 15.597C20.0201 16.0775 20.3406 16.6542 20.5668 17.3269C20.7931 17.9859 20.9062 18.7135 20.9062 19.5098C20.9062 20.3061 20.7868 21.0407 20.548 21.7134C20.3217 22.3861 20.0012 22.9628 19.5864 23.4433C19.1716 23.9101 18.6814 24.2739 18.1158 24.5348C17.5627 24.7956 16.9531 24.9192 16.2869 24.9054C15.5704 24.9054 14.9356 24.7407 14.3826 24.4112C13.8421 24.0817 13.4147 23.6561 13.1005 23.1344H13.0062V27.4502H10.8568V14.382H13.0062V15.8029H13.1005C13.4273 15.3087 13.8609 14.9037 14.4014 14.5879C14.9419 14.2721 15.5704 14.1074 16.2869 14.0936ZM15.8532 22.6401C16.2806 22.6401 16.6702 22.5577 17.0222 22.393C17.3741 22.2282 17.6758 22.0086 17.9272 21.734C18.1786 21.4457 18.3734 21.1093 18.5117 20.7249C18.65 20.3405 18.7191 19.9286 18.7191 19.4893C18.7191 19.0499 18.65 18.638 18.5117 18.2536C18.3734 17.8692 18.1786 17.5397 17.9272 17.2651C17.6758 16.9768 17.3741 16.7503 17.0222 16.5855C16.6702 16.4208 16.2806 16.3384 15.8532 16.3384C15.4259 16.3384 15.0362 16.4208 14.6842 16.5855C14.3449 16.7503 14.0495 16.9768 13.7981 17.2651C13.5593 17.5397 13.3707 17.8692 13.2325 18.2536C13.0942 18.638 13.0251 19.0499 13.0251 19.4893C13.0251 19.9149 13.0942 20.3199 13.2325 20.7043C13.3707 21.0887 13.5593 21.4251 13.7981 21.7134C14.0495 22.0017 14.3449 22.2282 14.6842 22.393C15.0362 22.5577 15.4259 22.6401 15.8532 22.6401Z"
                        fill="currentColor"
                    />
                    <path
                        d="M26.8822 24.9054C26.1155 24.9054 25.4178 24.7682 24.7894 24.4936C24.1734 24.2053 23.6455 23.8208 23.2056 23.3403C22.7656 22.8461 22.42 22.2694 22.1686 21.6104C21.9298 20.9514 21.8104 20.2444 21.8104 19.4893C21.8104 18.7341 21.9298 18.0271 22.1686 17.3681C22.4074 16.7091 22.7468 16.1393 23.1867 15.6588C23.6392 15.1783 24.1734 14.8007 24.7894 14.5261C25.4178 14.2378 26.1155 14.0936 26.8822 14.0936C27.6364 14.0936 28.3214 14.2378 28.9373 14.5261C29.5533 14.8007 30.0749 15.1783 30.5023 15.6588C30.9422 16.1393 31.2816 16.7091 31.5204 17.3681C31.7592 18.0271 31.8786 18.7341 31.8786 19.4893C31.8786 20.2444 31.7592 20.9514 31.5204 21.6104C31.2816 22.2694 30.9422 22.8461 30.5023 23.3403C30.0623 23.8208 29.5344 24.2053 28.9185 24.4936C28.3151 24.7682 27.6364 24.9054 26.8822 24.9054ZM26.8822 22.6401C27.3096 22.6401 27.6929 22.5577 28.0323 22.393C28.3843 22.2282 28.6797 22.0017 28.9185 21.7134C29.1699 21.4251 29.3647 21.0956 29.503 20.7249C29.6412 20.3405 29.7104 19.9355 29.7104 19.5098C29.7104 19.0705 29.6412 18.6655 29.503 18.2948C29.3647 17.9104 29.1699 17.5809 28.9185 17.3063C28.6797 17.018 28.3843 16.7915 28.0323 16.6267C27.6929 16.4619 27.3096 16.3796 26.8822 16.3796C26.4423 16.3796 26.0463 16.4619 25.6944 16.6267C25.3424 16.7915 25.0408 17.018 24.7894 17.3063C24.538 17.5809 24.3431 17.9104 24.2049 18.2948C24.0666 18.6655 23.9975 19.0705 23.9975 19.5098C23.9975 19.9355 24.0666 20.3405 24.2049 20.7249C24.3431 21.1093 24.538 21.4457 24.7894 21.734C25.0408 22.0086 25.3424 22.2282 25.6944 22.393C26.0589 22.5577 26.4548 22.6401 26.8822 22.6401Z"
                        fill="currentColor"
                    />
                    <path
                        d="M42.0975 22.3518H43.7001V24.6171H41.6073H34.4048H32.312V22.3518H32.5382C32.6891 22.3518 32.8399 22.3449 32.9907 22.3312C33.1542 22.3038 33.305 22.242 33.4433 22.1459C33.5941 22.036 33.7198 21.8644 33.8204 21.631C33.9209 21.3839 33.9838 21.0475 34.0089 20.6219C34.0215 20.3748 34.0278 20.0041 34.0278 19.5098C34.0403 19.0156 34.0466 18.4733 34.0466 17.8829C34.0592 17.2926 34.0655 16.6885 34.0655 16.0707C34.078 15.4391 34.0843 14.8762 34.0843 14.382H42.0975V22.3518ZM39.9292 22.3518V16.6679H36.1583C36.1457 17.3406 36.1332 18.0202 36.1206 18.7067C36.1206 19.3794 36.108 19.9492 36.0829 20.416C36.0577 20.8141 36.02 21.1779 35.9698 21.5075C35.9195 21.8232 35.8566 22.1047 35.7812 22.3518H39.9292Z"
                        fill="currentColor"
                    />
                    <path
                        d="M55.684 18.4184C56.2999 18.4733 56.7902 18.7067 57.1547 19.1186C57.5192 19.5304 57.7014 20.1071 57.7014 20.8484V24.6171H55.5332V21.4045C55.5332 21.1299 55.4578 20.9171 55.3069 20.7661C55.1561 20.6013 54.9487 20.5189 54.6847 20.5189H52.2902V24.6171H50.122V20.5189H47.7086C47.1555 20.5189 46.879 20.8141 46.879 21.4045V24.6171H44.7107V20.8484C44.7107 20.1071 44.8867 19.5304 45.2386 19.1186C45.6032 18.7067 46.0934 18.4733 46.7093 18.4184L44.541 14.382H46.879L49.0095 18.3978H50.122V14.382H52.2902V18.3978H53.4026L55.5332 14.382H57.8523L55.684 18.4184Z"
                        fill="currentColor"
                    />
                    <path
                        d="M63.6646 14.0936C64.4439 14.0936 65.1416 14.2515 65.7575 14.5673C66.386 14.8831 66.9076 15.3224 67.3224 15.8853C67.7498 16.4345 68.064 17.0935 68.2651 17.8623C68.4662 18.6174 68.5291 19.4343 68.4537 20.313H61.0438C61.1318 20.972 61.4084 21.5349 61.8735 22.0017C62.3511 22.4548 62.9607 22.695 63.7023 22.7225C64.2303 22.7362 64.7079 22.6264 65.1353 22.393C65.5626 22.1459 65.8706 21.8164 66.0591 21.4045H68.3028C68.152 21.9537 67.9257 22.4479 67.6241 22.8872C67.335 23.3266 66.9893 23.6973 66.5871 23.9993C66.1848 24.2876 65.7323 24.5073 65.2295 24.6583C64.7393 24.8231 64.2177 24.9054 63.6646 24.9054C62.8979 24.9054 62.2128 24.7613 61.6095 24.473C61.0061 24.1847 60.4971 23.7934 60.0823 23.2991C59.6675 22.8049 59.3469 22.2351 59.1207 21.5898C58.907 20.9308 58.8002 20.2375 58.8002 19.5098C58.8002 18.7547 58.9196 18.0477 59.1584 17.3887C59.3972 16.7297 59.7303 16.1599 60.1577 15.6794C60.5851 15.1851 61.0941 14.8007 61.6849 14.5261C62.2882 14.2378 62.9482 14.0936 63.6646 14.0936ZM63.6269 16.2766C62.9733 16.2766 62.4202 16.4688 61.9677 16.8532C61.5152 17.2377 61.2198 17.7456 61.0816 18.3772H66.21C66.0717 17.7319 65.77 17.2239 65.305 16.8532C64.8525 16.4688 64.2931 16.2766 63.6269 16.2766Z"
                        fill="currentColor"
                    />
                    <path
                        d="M76.5849 18.4184C77.1883 18.487 77.6659 18.7273 78.0179 19.1392C78.3698 19.5373 78.5458 20.1071 78.5458 20.8484V24.6171H76.3775V21.4045C76.3775 21.1299 76.3021 20.9171 76.1513 20.7661C76.0005 20.6013 75.7931 20.5189 75.5291 20.5189H72.041V24.6171H69.8727V14.382H72.041V18.3978H74.247L76.3398 14.382H78.6966L76.5849 18.4184Z"
                        fill="currentColor"
                    />
                    <path
                        d="M88 16.6679H84.8136V24.6171H82.6453V16.6679H79.4401V14.382H88V16.6679Z"
                        fill="currentColor"
                    />
                </svg>
                <div :class="$style.rectangleTop">
                    <span ref="rectangleTop"></span>
                </div>
                <div :class="$style.rectangleBottom">
                    <span ref="rectangleBottom"></span>
                </div>
            </div>

            <div
                class="l3"
                :class="$style.text"
                v-html="text"
            >
            </div>
        </div>
    </component>
</template>

<style lang="scss"
       module
>
    .LogoIda {
        cursor: pointer;

        &._black {
            --color: #{$base-600};
        }

        &._white {
            --color: #{$base-0};
        }
    }

    .wrapper {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .inner {
        position: relative;
        flex-shrink: 0;
        width: 9rem;
        height: 3rem;
        padding: 1px;
    }

    .rectangleTop,
    .rectangleBottom {
        position: absolute;
        left: -1px;
        overflow: hidden;

        span {
            position: absolute;
            top: 0;
            right: -2px;
            left: -2px;
            height: 100%;
            background: linear-gradient(to right, var(--color) 50%, transparent 50%) 100%;
            background-size: 200% 100%;
        }
    }

    .rectangleTop {
        top: 0;
        width: 39%;
        height: 50%;
    }

    .rectangleBottom {
        bottom: 0;
        width: 100%;
        height: calc(50% + 1px);
    }

    .logoIcon {
        width: 100%;
        height: 100%;
        color: var(--color);
        transform: translate3d(0, 0, 0);
    }

    .text {
        flex-shrink: 0;
        margin-left: 2.4rem;
        font-size: 1.2rem;
        line-height: 1.6rem;
    }
</style>
